# R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

## Including Plots

插入图像

```{r lena,fig.cap="lena", echo=FALSE,small.mar = TRUE,out.width="45%",fig.asp=1}
library(png)
library(jpeg)
library(bmp)
library(IM)
# create an object of class "Image"
data(lena)
obj = new("Image",img=img)
# display image
displayImg(obj@I)
```

分组散点图添加平滑线和回归线

```{r scatter-iris, echo=FALSE,fig.cap="线性回归模型",out.width="45%",small.mar = TRUE,fig.asp=1}
library(car)
scatterplot(Sepal.Length ~ Sepal.Width, col = c("black","red","blue"), pch=c(16,16,16),
            smooth = TRUE, boxplots = "xy", groups = iris$Species, 
            xlab = "Sepal.Width", ylab = "Sepal.Length", data = iris
)
```

插入 TikZ 制作的图形，一行两列

```{r linear-model,dev='tikz',fig.cap="线性回归模型",out.width="80%",echo=FALSE,fig.pos="!htb",twocols.mar=TRUE}
x <- rnorm(10)
y <- x + rnorm(5, sd = 0.25)
model <- lm(y ~ x)
rsq <- summary(model)$r.squared
rsq <- signif(rsq, 4)
plot(x, y, main = "Hello \\LaTeX!", xlab = "$x$", ylab = "$y$")
abline(model, col = "red")
mtext(paste("Linear model: $R^{2}=", rsq, "$"), line = 0.5)
legend("bottomright", legend = paste("$y = ", round(coef(model)[2], 3),
  "x +", round(coef(model)[1], 3), "$",
  sep = ""
), bty = "n")

plot(x, y, main = "Hello \\LaTeX!", xlab = "$x$", ylab = "$y$")
abline(model, col = "red")
mtext(paste("Linear model: $R^{2}=", rsq, "$"), line = 0.5)
legend("bottomright", legend = paste("$y = ", round(coef(model)[2], 3),
  "x +", round(coef(model)[1], 3), "$",
  sep = ""
), bty = "n")
```

